<mvc:View 
    xmlns:odata="sap.ui.comp.odata"
    controllerName="operations.controller.Transfer"
    xmlns:rowmodes="sap.ui.table.rowmodes"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:f="sap.ui.layout.form"
    xmlns:l="sap.ui.layout"
    xmlns:core="sap.ui.core"
    xmlns:ui="sap.ui.table"
>
    <Page
    busyIndicatorDelay="500">
        <content>
            <HBox
                class="sapUiSmallMargin"
                alignItems="Center"
            >
                <Label
                    text="Trade Number"
                    class="sapUiSmallMarginEnd"
                />
              <ComboBox
                    id="topTradeNumberCombo"
                    selectedKey="{appModel>/TrdNum}"
                    items="{
                        path: 's4HanaModel>/ZTA_TRADE_ENTRYSet',
                        filters: [
                            {
                                path: 'TrdNumP',
                                operator: 'EQ',
                                value1: ''
                            }
                        ],
                        sorter: {path: 'TrdNum'}
                    }"
                    selectionChange="onchangetradeno"
                    showSecondaryValues="false"
                    filterSecondaryValues="true"
                    width="200px"
                >
                    <core:Item
                        key="{s4HanaModel>TrdNum}"
                        text="{s4HanaModel>TrdNum}"
                    />
                </ComboBox>
     <Toolbar design="Transparent">
      <ToolbarSpacer />
    <Button
        id="editBtn"
        width="75px"
        text="Edit"
        icon="sap-icon://edit"
        press=".onEditPress"
        type="Emphasized"
        visible="{appModel>/IsEditBtnVisible}"
    />
    <Button
        id="draftBtn"
        width="75px"
        text="Draft"
        icon="sap-icon://save"
        press=".onPressDraft"
        type="Default"
        visible="{appModel>/IsSaveBtnVisible}"
    />
    <Button
        id="saveBtn"
        width="75px"
        text="Save"
        icon="sap-icon://save"
        press=".onPressSave"
        type="Accept"
        visible="{appModel>/IsSaveBtnVisible}"
    />
</Toolbar>
            </HBox>

            <!-- ===== START: Top Trade Details Table (bound to appModel TradeDetails as object property binding) ===== -->
            <ui:Table
                id="transferTableId"
                rows="{path:'appModel>/TradeDetails'}"
                selectionMode="Single"
            >
                <ui:rowMode>
                    <rowmodes:Fixed rowCount="1"/>
                </ui:rowMode>
                <ui:columns>
                    <ui:Column width="8rem">
                    <Label text="Vessel" />
                    <ui:template>   <ComboBox
                                    width="100%"
                                    selectedKey="{appModel>TrdVeh}"
                                    items="{path: 's4HanaModel>/ZTA_VEHICLESet', sorter: {path: 's4HanaModel>TrdVehD'}}" enabled="{appModel>/IsEditable}"
                                >
                                    <core:Item
                                        key="{s4HanaModel>TrdVeh}"
                                        text="{s4HanaModel>TrdVehD}"
                                    />
                                </ComboBox>
                     
                        </ui:template>
                    </ui:Column>

                    <ui:Column width="8rem">
                        <Label text="Vessel IMO" />
                        <ui:template>
                            <VBox>
                                <!-- <Text text="Key: {appModel>TrdTrdr}" class="sapUiTinyMarginBottom"/> -->
                                <ComboBox
                                    width="100%"
                                    selectedKey="{appModel>TrdVeh}"
                                    items="{path: 's4HanaModel>/ZTA_VEHICLESet', sorter: {path: 's4HanaModel>TrdVehD'}}" enabled="{appModel>/IsEditable}"
                                >
                                    <core:Item
                                        key="{s4HanaModel>TrdVeh}"
                                        text="{s4HanaModel>TrdVehD}"
                                    />
                                </ComboBox>
                            </VBox>

                        </ui:template>
                    </ui:Column>
                    <ui:Column width="8rem">
                        <Label text="Delivery Term" />
                        <ui:template>
                            <Select width="100%"
                             selectedKey="{appModel>TrdDlvtrm}"
                             enabled="false"
                             items="{path: 's4HanaModel>/ZTA_DLV_TRMSSet', sorter: {path: 's4HanaModel>TrdDlvtrmD'}}">
                                <core:Item
                                    key="{s4HanaModel>TrdDlvtrm}"
                                    text="{s4HanaModel>TrdDlvtrmD}"
                                />
                            </Select>
                        </ui:template>
                    </ui:Column>

                    <ui:Column width="10rem">
                        <Label text="BL Quantity in BBL" />
                        <ui:template>
                            <Input
                                value="{appModel>Lp1Qtybbl}" enabled="{appModel>/IsEditable}"
                            />
                        </ui:template>
                    </ui:Column>

                    <ui:Column width="10rem">
                        <Label text="BL Quantity in MT" />
                        <ui:template>
                             <Input
                                value="{appModel>Lp1Qtymt}" enabled="{appModel>/IsEditable}"
                            />
                        </ui:template>
                    </ui:Column>

                    <ui:Column width="10rem">
                        <Label text="BL Date" />
                        <ui:template>
                           <DatePicker
                                value="{appModel>BlDate}" enabled="{appModel>/IsEditable}"
                            />
                        </ui:template>
                    </ui:Column>

                    <ui:Column width="10rem">
                        <Label text="Window Start Date" />
                         <ui:template>
                            <DatePicker
                                value="{appModel>TrdWsdt}" enabled="{appModel>/IsEditable}"
                            />
                        </ui:template>
                    </ui:Column>
                     <ui:Column width="10rem">
                        <Label text="Window End Date" />
                         <ui:template>
                            <DatePicker
                                value="{appModel>TrdWedt}" enabled="{appModel>/IsEditable}"
                            />
                        </ui:template>
                    </ui:Column>
                     <ui:Column width="10rem">
                        <Label text="NOR Date" />
                         <ui:template>
                            <DatePicker
                                value="{appModel>NorDate}" enabled="{appModel>/IsEditable}"
                            />
                        </ui:template>
                    </ui:Column>
                    <ui:Column width="10rem">
                        <Label text="Discharge Date" />
                         <ui:template>
                            <DatePicker id = "dschDate"
                                value="{appModel>DschDate}" enabled="{appModel>/IsEditable}"
                            />
                        </ui:template>
                    </ui:Column>
                     <!-- <ui:Column width="12rem">
                        <Label text="BL Date" />
                         <ui:template>
                            <DatePicker
                                value="{appModel>}" enabled="{appModel>/IsEditable}"
                            />
                        </ui:template>
                    </ui:Column> -->

                    <ui:Column width="10rem">
                        <Label text="Discharge Port" />
                        <ui:template>
                            <ComboBox width="100%"
                             selectedKey="{appModel>TrdDsprt}"
                             enabled="false"
                             items="{path: 's4HanaModel>/ZTA_DSCH_PORTSet', sorter: {path: 's4HanaModel>TrdDsprtD'}}">
                                <core:Item
                                    key="{s4HanaModel>TrdDsprt}"
                                    text="{s4HanaModel>TrdDsprtD}"
                                />
                            </ComboBox>
                        </ui:template>
                    </ui:Column>
                </ui:columns>
            </ui:Table>
            <!-- ===== END: Top Trade Details Table ===== -->

               <Panel
                    expandable="true"
                    expanded="true"
                    headerText="Cost"
                    width="auto"
                    class="sapUiMediumMarginTop"
                >
                    <ui:Table
                                id="costTableId"
                                rows="{
                                    path: 'costModel>/'
                                }"
                                selectionMode="Multi"
                                selectionBehavior="Row"
                                rowSelectionChange=".onRowSelectionChange"
                                enableColumnReordering="false"
                            >
                                <!-- Header Toolbar -->
                                <ui:extension>
                                    <OverflowToolbar>
                                        <content>
                                            <ToolbarSpacer />
                                            <Button
                                                id="toggleAddBtn"
                                                text="Add"
                                                icon="sap-icon://add"
                                                press=".onToggleAdd"
                                            />

                                            <Button
                                                id="toggleSaveBtn"
                                                text="Save"
                                                icon="sap-icon://save"
                                                press=".onToggleSave"
                                                enabled="false"
                                                visible="{appModel>/IsCOSTSaveActive}"
                                            />

                                            <Button
                                                id="toggleEditBtn"
                                                text="Edit"
                                                icon="sap-icon://edit"
                                                press=".onToggleEdit"
                                                enabled="{appModel>/IsCOSTSelectionActive}"
                                            />
                                            <Button
                                                id="toggleDeleteBtn"
                                                text="Delete"
                                                enabled="{appModel>/IsCOSTSelectionActive}"
                                                icon="sap-icon://delete"
                                                press=".onToggleDel"
                                            />
                                        </content>
                                    </OverflowToolbar>
                                </ui:extension>

                                <!-- Columns -->
                                <ui:columns>
                                    <!-- Cost Type (editable ComboBox) -->
                                    <ui:Column width="12rem">
                                        <Label text="{i18n>COST_TYPE}" />
                                        <ui:template>
                                            <ComboBox
                                                selectedKey="{costModel>CstType}"
                                                enabled="{costModel>isRowEditable}"
                                                items="{ path: 's4HanaModel>/ZTA_CST_TYPESet' }"
                                            >
                                                <core:Item
                                                    key="{s4HanaModel>CstType}"
                                                    text="{s4HanaModel>CstTypeD}"
                                                />
                                            </ComboBox>
                                        </ui:template>
                                    </ui:Column>
                                    
                                    <!-- Cost Status -->
                                    <ui:Column width="12rem">
                                        <Label text="{i18n>COST_STATUS}" />
                                        <ui:template>
                                            <ComboBox
                                                selectedKey="{costModel>CstEstfn}"
                                                enabled="{costModel>isRowEditable}"
                                                items="{ path: 's4HanaModel>/ZTA_CST_ESTFINSet' }"
                                            >
                                                <core:Item
                                                    key="{s4HanaModel>CstEstfn}"
                                                    text="{s4HanaModel>CstEstfnD}"
                                                />
                                            </ComboBox>
                                        </ui:template>
                                    </ui:Column>

                                    <!-- Price Type (editable ComboBox) -->
                                    <ui:Column width="12rem">
                                        <Label text="{i18n>PRICE_TYPE}" />
                                        <ui:template>
                                            <ComboBox
                                                selectedKey="{costModel>CstPrctyp}"
                                                enabled="{costModel>isRowEditable}"
                                                items="{ path: 's4HanaModel>/ZTA_PRC_TYPESet' }"
                                            >
                                                <core:Item
                                                    key="{s4HanaModel>CstPrctyp}"
                                                    text="{s4HanaModel>CstPrctypD}"
                                                />
                                            </ComboBox>
                                        </ui:template>
                                    </ui:Column>
                                    <!-- Total Value (editable ComboBox) -->
                                    <ui:Column width="12rem">
                                        <Label text="{i18n>TOT_VALUE}" />
                                        <ui:template>
                                            <Input 
                                                value="{costModel>CstTotval}"
                                                enabled="{costModel>isRowEditable}" />
                                        </ui:template>
                                      
                                    </ui:Column>

                                    

                                    <!-- Expense Currency -->
                                    <ui:Column width="12rem">
                                        <Label text="{i18n>EXPENSE_CURR}" />
                                        <ui:template>
                                            <ComboBox
                                                selectedKey="{costModel>CstExpcur}"
                                                enabled="{costModel>isRowEditable}"
                                                items="{ path : 's4HanaModel>/ZTA_CURRENCYSet' }"
                                            >
                                                <core:Item
                                                    key="{s4HanaModel>CurrencyId}"
                                                    text="{s4HanaModel>CurrencyD}"
                                                />
                                            </ComboBox>
                                        </ui:template>
                                    </ui:Column>

                                    <!-- Settlement Currency -->
                                    <ui:Column width="12rem">
                                        <Label text="{i18n>SETTLEMENT_CURR}" />
                                        <ui:template>
                                            <ComboBox
                                                selectedKey="{costModel>CstStcur}"
                                                enabled="{costModel>isRowEditable}"
                                                items="{ path : 's4HanaModel>/ZTA_CURRENCYSet' }"
                                            >
                                                <core:Item
                                                    key="{s4HanaModel>CurrencyId}"
                                                    text="{s4HanaModel>CurrencyD}"
                                                />
                                            </ComboBox>
                                        </ui:template>
                                    </ui:Column>

                                    <!-- Exchange Rate -->
                                    <ui:Column width="12rem">
                                        <Label text="{i18n>EXCHNG_RATE}" />
                                        <ui:template>
                                            <Input 
                                                value="{costModel>CstExrt}"
                                                enabled="{costModel>isRowEditable}" />
                                        </ui:template>
                                    </ui:Column>

                                    <!-- Payment Due  -->
                                    <ui:Column width="12rem">
                                        <Label text="{i18n>PAYMENT_DUE}" />
                                        <ui:template>
                                            <DatePicker
                                                value="{path: 'costModel>CstPaydt', formatter: '.formatter.formatDate'}"
                                                displayFormat="dd-MM-yyyy"
                                                valueFormat="yyyy-MM-dd"
                                                enabled="{costModel>isRowEditable}"
                                            />
                                        </ui:template>
                                    </ui:Column>

                                    <!-- Company -->
                                    <ui:Column width="12rem">
                                        <Label text="{i18n>COMPANY}" />
                                        <ui:template>
                                            <ComboBox
                                                selectedKey="{costModel>CstComp}"
                                                enabled="{costModel>isRowEditable}"
                                                items="{ path : 's4HanaModel>/ZTA_CST_VENDSet' }"
                                            >
                                                <core:Item
                                                    key="{s4HanaModel>CstComp}"
                                                    text="{s4HanaModel>CstCompD}"
                                                />
                                            </ComboBox>
                                        </ui:template>
                                    </ui:Column>

                                    <!-- Payment -->
                                    <ui:Column width="12rem">
                                        <Label text="{i18n>PRICING_FORMULA}" />
                                        <ui:template>
                                            <ComboBox
                                                selectedKey=""
                                                enabled="{costModel>isRowEditable}"
                                                items=""
                                            >
                                                <core:Item
                                                    key=""
                                                    text=""
                                                />
                                            </ComboBox>
                                        </ui:template>
                                    </ui:Column>
                                </ui:columns>
                            </ui:Table>
                </Panel>
                <Panel
                                headerText="Purchase Order Input"
                                expandable="true"
                                expanded="true"
                                class="sapUiMediumMarginTop"
                            >
                                <!-- Two Column Layout using HBox -->
                                <!-- <HBox class="sapUiSmallMargin" width="100%"> -->
                                    <!-- Left Column: Dates and Load Port -->
                                    <VBox width="50%" class="sapUiSmallMarginEnd">
                                        <!-- Dates Section -->
                                        <!-- <Title text="Dates" class="sapUiSmallMarginBottom" /> -->

                                        <!-- <Label text="Window Start Date" class="sapUiTinyMarginTop" />
                                        <DatePicker id="windowStartDate" value="{appModel>/TradeDetails/0/TrdWsdt}"
                                                    displayFormat="dd-MM-yyyy" valueFormat="yyyy-MM-dd"
                                                    width="100%" enabled="{appModel>/IsEditable}" class="sapUiTinyMarginBottom" /> -->

                                        <!-- <Label text="Window End Date" class="sapUiTinyMarginTop" />
                                        <DatePicker id="windowEndDate" value="{appModel>/TradeDetails/0/TrdWedt}"
                                                    displayFormat="dd-MM-yyyy" valueFormat="yyyy-MM-dd"
                                                    width="100%" enabled="{appModel>/IsEditable}" class="sapUiTinyMarginBottom" />

                                        <Label text="NOR Date" class="sapUiTinyMarginTop" />
                                        <DatePicker id="norDate" value="{appModel>/TradeDetails/0/NorDate}"
                                                    displayFormat="dd-MM-yyyy" valueFormat="yyyy-MM-dd"
                                                    width="100%" enabled="{appModel>/IsEditable}" class="sapUiTinyMarginBottom" />

                                        <Label text="BL Date" class="sapUiTinyMarginTop" />
                                        <DatePicker id="blDate" value="{appModel>/TradeDetails/0/BlDate}"
                                                    displayFormat="dd-MM-yyyy" valueFormat="yyyy-MM-dd"
                                                    width="100%" enabled="{appModel>/IsEditable}" class="sapUiTinyMarginBottom" /> -->

                                        <!-- Load Port Section -->
                                        <VBox id="loadPortSection" visible="{appModel>/ShowLoadPortPanel}">
                                        <Title text="Load Port" class="sapUiSmallMarginTop sapUiSmallMarginBottom"  />

                                        <Label text="Load Port Quantity in BBL" class="sapUiTinyMarginTop" />
                                        <Input id="loadPortQtyBbl" value="{appModel>/TradeDetails/0/Lp1Qtybbl}" width="100%" enabled="{appModel>/IsEditable}" class="sapUiTinyMarginBottom"  />

                                        <Label text="Load Port Quantity in MT" class="sapUiTinyMarginTop" />
                                        <Input id="loadPortQtyMt" value="{appModel>/TradeDetails/0/Lp1Qtymt}" width="100%" enabled="{appModel>/IsEditable}" class="sapUiTinyMarginBottom" />

                                        <Label text="Load Port Temperature in Deg C" class="sapUiTinyMarginTop" />
                                        <Input id="loadPortTmp" value="{appModel>/TradeDetails/0/Lp1Tmp}" width="100%" enabled="{appModel>/IsEditable}" class="sapUiTinyMarginBottom" />

                                        <Label text="Load Port API" class="sapUiTinyMarginTop" />
                                        <Input id="loadPortApi" value="{appModel>/TradeDetails/0/Lp1Api}" width="100%" enabled="{appModel>/IsEditable}" class="sapUiTinyMarginBottom" />

                                        <Label text="Load Port Title Transfer Date" class="sapUiTinyMarginTop" />
                                        <DatePicker id="loadPortTrndt" value="{appModel>/TradeDetails/0/Lp1Trndt}"
                                                    displayFormat="dd-MM-yyyy" valueFormat="yyyy-MM-dd"
                                                    width="100%" enabled="{appModel>/IsEditable}" class="sapUiTinyMarginBottom" />

                                        <Label text="Load Port Miscellaneous / Other" class="sapUiTinyMarginTop" />
                                        <HBox width="100%" class="sapUiTinyMarginBottom">
                                            <Input id="loadPortMsc" value="{appModel>/TradeDetails/0/Lp1Msc}" width="60%" enabled="{appModel>/IsEditable}" class="sapUiSmallMarginEnd" />
                                            <ComboBox id="loadPortMscuom" selectedKey="{appModel>/TradeDetails/0/Lp1Mscuom}" width="40%" enabled="{appModel>/IsEditable}" items="{ path: 's4HanaModel>/ZTA_CURRENCYSet', sorter: { path: 's4HanaModel>CurrencyD' } }">
                                                <core:Item key="{s4HanaModel>CurrencyId}" text="{s4HanaModel>CurrencyD}" />
                                            </ComboBox>
                                        </HBox>
                                          </VBox>
                                           </VBox>
                                   

                                    <!-- Right Column: Discharge Port -->
                                    <VBox width="50%" visible="{appModel>/ShowDischargePortPanel}">
                                        <!-- Discharge Port Section -->
                                        <Title text="Discharge Port" class="sapUiSmallMarginTop sapUiSmallMarginBottom" />

                                        <Label text="Discharge Port Quantity in BBL" class="sapUiTinyMarginTop" />
                                        <Input id="discPortQtyBbl" value="{appModel>/TradeDetails/0/Dp1Qtybbl}" width="100%" enabled="{appModel>/IsEditable}" class="sapUiTinyMarginBottom" />

                                        <Label text="Discharge Port Quantity in MT" class="sapUiTinyMarginTop" />
                                        <Input id="discPortQtyMt" value="{appModel>/TradeDetails/0/Dp1Qtymt}" width="100%" enabled="{appModel>/IsEditable}" class="sapUiTinyMarginBottom" />

                                        <Label text="Discharge Port Temperature in Deg C" class="sapUiTinyMarginTop" />
                                        <Input id="discPortTmp" value="{appModel>/TradeDetails/0/Dp1Tmp}" width="100%" enabled="{appModel>/IsEditable}" class="sapUiTinyMarginBottom" />

                                        <Label text="Discharge Port API" class="sapUiTinyMarginTop" />
                                        <Input id="discPortApi" value="{appModel>/TradeDetails/0/Dp1Api}" width="100%" enabled="{appModel>/IsEditable}" class="sapUiTinyMarginBottom" />

                                        <Label text="Discharge Port Title Transfer Date" class="sapUiTinyMarginTop" />
                                        <DatePicker id="discPortTrndt" value="{appModel>/TradeDetails/0/Dp1Trndt}"
                                                    displayFormat="dd-MM-yyyy" valueFormat="yyyy-MM-dd"
                                                    width="100%" enabled="{appModel>/IsEditable}" class="sapUiTinyMarginBottom" />

                                        <Label text="Discharge Port Miscellaneous / Other" class="sapUiTinyMarginTop" />
                                        <HBox width="100%" class="sapUiTinyMarginBottom">
                                            <Input id="discPortMsc" value="{appModel>/TradeDetails/0/Dp1Msc}" width="60%" enabled="{appModel>/IsEditable}" class="sapUiSmallMarginEnd" />
                                            <ComboBox id="discPortMscuom" selectedKey="{appModel>/TradeDetails/0/Dp1Mscuom}" width="40%" enabled="{appModel>/IsEditable}" items="{ path: 's4HanaModel>/ZTA_CURRENCYSet', sorter: { path: 's4HanaModel>CurrencyD' } }">
                                                <core:Item key="{s4HanaModel>CurrencyId}" text="{s4HanaModel>CurrencyD}" />
                                            </ComboBox>
                                        </HBox>
                                    </VBox>
                                
                                <HBox class="sapUiSmallMarginTop" justifyContent="Start">
    <!-- <Button
        text="Add Another Discharge Port"
        icon="sap-icon://add"
        type="Emphasized"
        press=".onAddDischargePort"
        class="sapUiTinyMarginEnd"
    /> -->
     <Button
        text="Execute"
        icon="sap-icon://save"
        type="Emphasized"
        press=".onExecutePOCreation"
        class="sapUiTinyMarginEnd"
    />
      <Button
        text="Submit"
        icon="sap-icon://accept"
        type="Emphasized"
        press=".onSubmitPOCreation"
        class="sapUiTinyMarginEnd"
    />
</HBox>
                            </Panel>

                             
               <Panel 
    headerText="GRN STO Input"
    expandable="true"
    expanded="true"
    class="sapUiMediumMarginTop">

    <VBox class="sapUiSmallMargin">

        <Label text="Quantity in BBL" />
        <Input id="grnQtyBbl" value="{appModel>/TradeDetails/0/GrDp1Qtybbl}" width="15rem"
               enabled="{appModel>/IsEditable}" class="sapUiTinyMarginBottom" />

              

        <Label text="Quantity in MT" />
        <Input id="grnQtyMt" value="{appModel>/TradeDetails/0/GrDp1Qtymt}" width="15rem"
               enabled="{appModel>/IsEditable}" class="sapUiTinyMarginBottom" />

        <Label text="Temperature (Â°C)" />
        <Input id="grnTmp" value="{appModel>/TradeDetails/0/GrDp1Tmp}" width="15rem"
               enabled="{appModel>/IsEditable}" class="sapUiTinyMarginBottom" />

        <Label text="API"/>
        <Input id="grnApi" value="{appModel>/TradeDetails/0/GrDp1Api}" width="15rem"
               enabled="{appModel>/IsEditable}" class="sapUiTinyMarginBottom" />

        <Label text="Title Transfer Date" />
        <DatePicker id="grnTrndt"
                    value="{appModel>/TradeDetails/0/GrDp1Trndt}"
                    displayFormat="dd-MM-yyyy"
                    valueFormat="yyyy-MM-dd"
                    width="15rem"
                    enabled="{appModel>/IsEditable}"
                    class="sapUiTinyMarginBottom" />
    </VBox>

    <HBox class="sapUiSmallMarginTop" justifyContent="Start">
        <Button
            text="Execute"
            icon="sap-icon://save"
            type="Emphasized"
            press=".onExecuteGRNCreation"
            class="sapUiTinyMarginEnd"/>
        <Button
            text="Submit"
            icon="sap-icon://accept"
            type="Emphasized"
            press=".onSubmitGRNCreation"
            class="sapUiTinyMarginEnd" />
    </HBox>
</Panel>



                            
                            
        </content>
    </Page>
</mvc:View>
